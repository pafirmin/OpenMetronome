(this["webpackJsonpmetronome-app"]=this["webpackJsonpmetronome-app"]||[]).push([[0],{76:function(e,t,n){"use strict";n.r(t);var r,i,c,o,a,s,u,b,l,m,j,d,p,O,h=n(0),f=n.n(h),x=n(18),g=n.n(x),y=n(5),v=n(6),C=n(14),k=n(7),T="TOGGLE_IS_PLAYING",E="SET_TEMPO",N="SET_METRE",P="SET_NOTE_VALUE",w="INCREMENT_BEAT_COUNT",A="RESET_BEAT_COUNT",R="NEXT_PROGRAM_CHUNK",S="CLEAR_PROGRAM",_="ADD_TO_PROGRAM",M="REMOVE_FROM_PROGRAM",I=function(e){return{type:E,payload:e}},z=function(e){return{type:N,payload:e}},F=function(e){return{type:P,payload:e}},G=function(e){return{type:R,payload:e}},V=n(90),L=n(34),D=n.n(L),U=n(51),q=n.n(U),B=n(2),J=v.c.div(r||(r=Object(y.a)(["\n  margin: 1rem auto 0 auto;\n  text-align: center;\n  width: 100%;\n"]))),X=v.c.div(i||(i=Object(y.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 1.4rem;\n  margin: 0 auto;\n"]))),H=v.c.button(c||(c=Object(y.a)(["\n  border-radius: 0;\n  font-size: 1.6em;\n  padding: 0.6rem 1rem;\n  background: #425eca;\n  font: inherit;\n  color: inherit;\n  border: 1px solid #bdbdbd;\n  cursor: pointer;\n  width: 100px;\n\n  &:hover {\n    background: #33489b;\n  }\n"]))),K=v.c.span(o||(o=Object(y.a)(["\n  font-size: 1.8em;\n  cursor: pointer;\n  color: ",";\n"])),(function(e){return e.selected?"red":"inherit"})),Q=function(){var e=Object(k.c)((function(e){return e.metronome})),t=e.tempo,n=e.metre,r=e.noteValue,i=e.isPlaying,c=Object(k.b)(),o=Object(h.useState)(t),a=Object(C.a)(o,2),s=a[0],u=a[1];return Object(B.jsxs)(J,{children:[Object(B.jsx)(V.a,{value:s,min:50,max:218,onChange:function(e,t){return u(t)},onChangeCommitted:function(){c(I(s))},valueLabelDisplay:"auto",valueLabelFormat:s+" bpm",color:"secondary"}),Object(B.jsx)(H,{onClick:function(){return c({type:T})},children:i?"Stop":"Start"}),Object(B.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:"1rem"},children:[Object(B.jsxs)("div",{style:{width:"150px"},children:[Object(B.jsx)("span",{style:{display:"block"},children:"Metre"}),Object(B.jsxs)(X,{children:[Object(B.jsx)(q.a,{onClick:function(){c(z(n-1))},role:"button","aria-label":"Decrement meter",style:{fontSize:40,cursor:"pointer"}}),Object(B.jsx)("span",{children:n}),Object(B.jsx)(D.a,{onClick:function(){c(z(n+1))},role:"button","aria-label":"Increment meter",style:{fontSize:40,cursor:"pointer"}})]})]}),Object(B.jsxs)("div",{style:{width:"150px"},children:[Object(B.jsx)("span",{style:{display:"block"},children:"Note"}),Object(B.jsxs)(X,{children:[Object(B.jsx)(K,{onClick:function(){c(F(1))},role:"button","aria-label":"Quarter note pulse",selected:1===r,children:"\u2669"}),Object(B.jsx)(K,{onClick:function(){c(F(.5))},role:"button","aria-label":"Eighth note pulse",selected:.5===r,children:"\u266b"})]})]})]})]})},Y=n(52),W=n(53),Z=n(54),$=n(57),ee=n(58),te=function(e){Object(Z.a)(n,e);var t=Object($.a)(n);function n(e){var r,i=e.onTick;return Object(Y.a)(this,n),(r=t.call(this)).tempo=120,r.metre=4,r.division=1,r.nextNoteTime=0,r.stopPulse=null,r.onTick=i,r.beatCount=0,r.gainNode=r.createGain(),r}return Object(W.a)(n,[{key:"init",value:function(){this.gainNode.connect(this.destination),this.gainNode.gain.value=.2,this.nextNoteTime=this.currentTime,this.startPulse()}},{key:"startPulse",value:function(){var e=this;this.stopPulse&&this.stopPulse();var t=setInterval((function(){return e.pulse()}),100);this.stopPulse=function(){clearInterval(t),e.beatCount=0}}},{key:"pulse",value:function(){for(;this.nextNoteTime<this.currentTime+.1;)this.nextNoteTime+=60/this.tempo*this.division,this.playTick(),this.beatCount+=this.division,this.beatCount===this.metre&&(this.beatCount=0)}},{key:"playTick",value:function(){var e=this.createOscillator();Number.isInteger(this.beatCount)&&(e.onended=this.onTick),e.connect(this.gainNode),e.frequency.value=this.getFrequency(),e.start(this.nextNoteTime),e.stop(this.nextNoteTime+.1)}},{key:"setTempo",value:function(e){this.tempo=e}},{key:"setMetre",value:function(e){this.metre=e}},{key:"setNoteValue",value:function(e){1===e&&(this.beatCount=Math.ceil(this.beatCount)),this.division=e}},{key:"getFrequency",value:function(){return this.beatCount%this.metre===0?550:Number.isInteger(this.beatCount)?450:350}}]),n}(Object(ee.a)(AudioContext)),ne=v.c.div(a||(a=Object(y.a)(["\n  position: relative;\n  width: 100%;\n  height: 300px;\n  margin: auto;\n"]))),re=v.c.span(s||(s=Object(y.a)(["\n  display: block;\n  font-size: 3rem;\n  text-align: center;\n"]))),ie=Object(v.d)(u||(u=Object(y.a)(["\n  0% {\n    transform: rotate(-45deg);\n  }\n  100% {\n    transform: rotate(45deg);\n  }\n"]))),ce=v.c.div(b||(b=Object(y.a)(["\n  width: 2px;\n  height: 80%;\n  position: absolute;\n  left: 50%;\n  bottom: 0;\n  background-color: #c4c4c4;\n  transform-origin: bottom center;\n  animation: ",';\n\n  &:after {\n    content: "";\n    position: absolute;\n    top: ',"%;\n    left: 50%;\n    transform: translate(-50%);\n    width: 20px;\n    height: 20px;\n    border-radius: 50%;\n    background-color: #c4c4c4;\n    transition: top 0.5s;\n  }\n"])),(function(e){return e.isPlaying&&Object(v.b)(l||(l=Object(y.a)(["\n      "," ","s linear infinite alternate\n    "])),ie,60/e.tempo)}),(function(e){return(e.tempo-50)/168*100})),oe=function(){var e=Object(k.b)(),t=Object(k.c)((function(e){return e.metronome})),n=t.tempo,r=t.metre,i=t.noteValue,c=t.isPlaying,o=Object(h.useRef)(new te({onTick:function(){return e({type:w,payload:t});var t}}));return Object(h.useEffect)((function(){o.current.setTempo(n)}),[n]),Object(h.useEffect)((function(){o.current.setMetre(r)}),[r]),Object(h.useEffect)((function(){o.current.setNoteValue(i)}),[i]),Object(h.useEffect)((function(){c?o.current.init():o.current.stopPulse&&(o.current.stopPulse(),setTimeout((function(){return e({type:A})}),1e3))}),[c,e]),Object(B.jsxs)(ne,{children:[Object(B.jsxs)(re,{children:[n,"bpm"]}),Object(B.jsx)(ce,{isPlaying:c,tempo:n})]})},ae=n(36),se=n(3),ue=n(55),be=v.c.form(m||(m=Object(y.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 1rem;\n\n  & input {\n    width: 3em;\n    font: inherit;\n    padding: 0.2rem;\n    border: none;\n    border-radius: 3px;\n  }\n\n  & > * + * {\n    margin-left: 0.5rem;\n  }\n"]))),le=function(){var e=Object(k.c)((function(e){return e.program})).program,t=Object(k.b)(),n=Object(h.useState)({measures:4,metre:4,tempo:120,silent:!1}),r=Object(C.a)(n,2),i=r[0],c=r[1],o=function(){var n={measures:Number(i.measures),metre:Number(i.metre),tempo:Number(i.tempo),silent:i.silent,id:Object(ue.v4)()};0===e.length&&t(G(n)),t({type:_,payload:n})},a=function(e){c(Object(se.a)(Object(se.a)({},i),{},Object(ae.a)({},e.target.name,e.target.value)))};return Object(B.jsxs)(be,{onSubmit:o,children:[Object(B.jsx)("input",{type:"number",name:"measures",id:"measures",value:i.measures,onChange:a}),Object(B.jsx)("label",{htmlFor:"measures",children:"bars of"}),Object(B.jsx)("label",{htmlFor:"metre",children:Object(B.jsx)("input",{type:"number",name:"metre",id:"metre",value:i.metre,onChange:a})}),Object(B.jsx)("span",{children:"at"}),Object(B.jsx)("input",{type:"number",min:60,max:220,name:"tempo",id:"tempo",value:i.tempo,onChange:a}),Object(B.jsx)("label",{htmlFor:"tempo",children:"bpm"}),Object(B.jsx)(D.a,{role:"button",onClick:o,"aria-label":"Add to program",style:{fontSize:30,cursor:"pointer"}})]})},me=function(){var e=Object(k.c)((function(e){return e.program})),t=e.program,n=e.currentChunk,r=Object(k.c)((function(e){return e.metronome.beatCount})),i=Object(k.b)();console.log(r);var c=function(e){1!==t.length?(e.id===n.id&&o(),i(function(e){return{type:M,payload:e}}(e))):i({type:S})},o=Object(h.useCallback)((function(){var e=t.indexOf(n)+1,r=t[e]||t[0];i(G(r))}),[n,t,i]);return Object(h.useEffect)((function(){n&&r===n.metre*n.measures&&o()}),[r,o,n]),Object(B.jsxs)("div",{children:[Object(B.jsx)(le,{}),t.map((function(e){return Object(B.jsxs)("p",{style:{textAlign:"center"},children:[e.measures," bars of ",e.metre," at ",e.tempo,"bpm"," ",Object(B.jsx)("button",{type:"button",onClick:function(){return c(e)},children:"Remove"})]},e.id)}))]})},je=function(){var e=Object(k.c)((function(e){return e.metronome})),t=e.tempo,n=e.metre,r=e.beatCount,i=e.isPlaying,c=Object(k.b)(),o=Object(h.useState)(0),a=Object(C.a)(o,2),s=a[0],u=a[1],b=Object(h.useState)(4),l=Object(C.a)(b,2),m=l[0],j=l[1];return Object(h.useEffect)((function(){i&&r%(m*n)===0&&(console.log(t+s),c(I(Math.min(t+Number(s),220))))}),[r]),Object(B.jsx)("div",{children:Object(B.jsxs)(be,{children:[Object(B.jsx)("label",{htmlFor:"tempo",children:"Increase tempo by"}),Object(B.jsx)("input",{min:0,max:50,type:"number",name:"tempoRamp",id:"tempo",value:s,onChange:function(e){return u(e.target.value)}}),Object(B.jsx)("span",{children:"bpm every"}),Object(B.jsx)("input",{min:1,type:"number",name:"measures",id:"measures",value:m,onChange:function(e){return j(e.target.value)}}),Object(B.jsx)("label",{htmlFor:"measures",children:"measures"})]})})},de=v.c.nav(j||(j=Object(y.a)(["\n  display: flex;\n  justify-content: space-evenly;\n  font-size: 1.5rem;\n  margin-bottom: 2rem;\n"]))),pe=v.c.span(d||(d=Object(y.a)(["\n  border-bottom: 2px solid #d3d3d3;\n  width: 200px;\n  text-align: center;\n  padding-bottom: 0.3rem;\n  position: relative;\n  color: ",';\n  cursor: pointer;\n  transition: color 0.3s;\n\n  &:after {\n    content: "";\n    position: absolute;\n    bottom: -2px;\n    left: 50%;\n    transform: translateX(-50%);\n    height: 2px;\n    width: ',";\n    background-color: red;\n    transition: width 0.3s;\n  }\n"])),(function(e){return e.isActive?"#dfdfdf":"#9d9d9d"}),(function(e){return e.isActive?"100%":"0"})),Oe=function(){var e=Object(h.useState)(1),t=Object(C.a)(e,2),n=t[0],r=t[1];return Object(B.jsxs)("div",{style:{marginTop:"2rem"},children:[Object(B.jsxs)(de,{children:[Object(B.jsx)(pe,{isActive:1===n,onClick:function(){return r(1)},children:"Tempo ramp"}),Object(B.jsx)(pe,{isActive:2===n,onClick:function(){return r(2)},children:"Custom"})]}),1===n&&Object(B.jsx)(je,{}),2===n&&Object(B.jsx)(me,{})]})},he=Object(v.a)(p||(p=Object(y.a)(["\n  body {\n    background-color: #333;\n    color: #dfdfdf;\n    font-family: 'Montserrat', sans-serif;\n  }\n"]))),fe=v.c.div(O||(O=Object(y.a)(["\n  width: 100%;\n  margin: 3rem auto 0 auto;\n\n  @media screen and (min-width: 600px) {\n    width: 600px;\n  }\n"]))),xe=function(){return Object(B.jsxs)(fe,{children:[Object(B.jsx)(he,{}),Object(B.jsx)(oe,{}),Object(B.jsx)(Q,{}),Object(B.jsx)(Oe,{})]})},ge={tempo:120,metre:4,noteValue:1,isPlaying:!1,beatCount:0},ye=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case T:return Object(se.a)(Object(se.a)({},e),{},{isPlaying:!e.isPlaying});case E:return Object(se.a)(Object(se.a)({},e),{},{tempo:r});case N:return Object(se.a)(Object(se.a)({},e),{},{metre:r});case P:return Object(se.a)(Object(se.a)({},e),{},{noteValue:r});case w:return Object(se.a)(Object(se.a)({},e),{},{beatCount:e.beatCount+1});case A:return Object(se.a)(Object(se.a)({},e),{},{beatCount:0});case R:return Object(se.a)(Object(se.a)({},e),{},{tempo:r.tempo,metre:r.metre,beatCount:0});default:return e}},ve=n(27),Ce=n(56),ke={program:[],currentChunk:{}},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ke,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case _:return Object(se.a)(Object(se.a)({},e),{},{program:[].concat(Object(Ce.a)(e.program),[r])});case M:return Object(se.a)(Object(se.a)({},e),{},{program:e.program.filter((function(e){return e.id!==r.id}))});case R:return Object(se.a)(Object(se.a)({},e),{},{currentChunk:r});case S:return ke;default:return e}},Ee=Object(ve.b)({metronome:ye,program:Te}),Ne=Object(ve.c)(Ee);g.a.render(Object(B.jsx)(f.a.StrictMode,{children:Object(B.jsx)(k.a,{store:Ne,children:Object(B.jsx)(xe,{})})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.aaed0671.chunk.js.map