(this["webpackJsonpmetronome-app"]=this["webpackJsonpmetronome-app"]||[]).push([[0],{76:function(e,t,n){"use strict";n.r(t);var r,c,i,o,a,s,u,b,l,j,m,d,p,O,f,h=n(0),x=n.n(h),g=n(18),v=n.n(g),y=n(4),C=n(5),T=n(11),E=n(7),k="TOGGLE_IS_PLAYING",_="SET_TEMPO",P="SET_METRE",N="SET_NOTE_VALUE",A="INCREMENT_BEAT_COUNT",S="RESET_BEAT_COUNT",M="NEXT_PROGRAM_CHUNK",R="CLEAR_PROGRAM",w="ADD_TO_PROGRAM",I="REMOVE_FROM_PROGRAM",F=function(e){return{type:_,payload:e}},z=function(e){return{type:P,payload:e}},V=function(e){return{type:N,payload:e}},D=function(e){return{type:M,payload:e}},G=n(90),L=n(34),U=n.n(L),B=n(51),H=n.n(B),K=n(2),X=C.c.button(r||(r=Object(y.a)(["\n  width: 100px;\n  height: 100px;\n  font-size: 1.1em;\n  border: 2px solid #fff;\n  color: #fff;\n  background-color: #575757;\n  cursor: pointer;\n  border-radius: 50%;\n"]))),q=function(){var e=Object({NODE_ENV:"production",PUBLIC_URL:"/OpenMetronome",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_MIN_TEMPO:"50",REACT_APP_MAX_TEMPO:"218"}),t=e.REACT_APP_MIN_TEMPO,n=e.REACT_APP_MAX_TEMPO,r=Object(h.useState)(),c=Object(T.a)(r,2),i=c[0],o=c[1],a=Object(E.b)();return Object(K.jsx)("div",{children:Object(K.jsx)(X,{onClick:function(){var e=performance.now();if(i){var r=e-i,c=Math.round(60/(r/1e3));c>n?c=n:c<t&&(c=t),a(F(c))}o(e)},children:"Tap Tempo"})})},W=C.c.div(c||(c=Object(y.a)(["\n  margin: 1rem auto 0 auto;\n  text-align: center;\n  width: 100%;\n"]))),J=C.c.div(i||(i=Object(y.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  font-size: 1.4rem;\n  margin: 0 auto;\n"]))),Q=C.c.button(o||(o=Object(y.a)(["\n  border-radius: 0;\n  font-size: 1.6em;\n  padding: 0.6rem 1rem;\n  background: #425eca;\n  font: inherit;\n  color: inherit;\n  border: 1px solid #bdbdbd;\n  cursor: pointer;\n  width: 100px;\n\n  &:hover {\n    background: #33489b;\n  }\n"]))),Y=C.c.span(a||(a=Object(y.a)(["\n  font-size: 1.8em;\n  cursor: pointer;\n  color: ",";\n"])),(function(e){return e.selected?"red":"inherit"})),Z=function(){var e=Object(E.c)((function(e){return e.metronome})),t=e.tempo,n=e.metre,r=e.noteValue,c=e.isPlaying,i=Object(E.b)(),o=Object(h.useState)(t),a=Object(T.a)(o,2),s=a[0],u=a[1];return Object(K.jsxs)(W,{children:[Object(K.jsx)(G.a,{value:s,min:Number("50"),max:Number("218"),onChange:function(e,t){return u(t)},onChangeCommitted:function(){i(F(s))},valueLabelDisplay:"auto",valueLabelFormat:s+" bpm",color:"secondary"}),Object(K.jsx)(Q,{onClick:function(){return i({type:k})},children:c?"Stop":"Start"}),Object(K.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"1rem"},children:[Object(K.jsxs)("div",{style:{width:"150px"},children:[Object(K.jsx)("span",{style:{display:"block"},children:"Metre"}),Object(K.jsxs)(J,{children:[Object(K.jsx)(H.a,{onClick:function(){i(z(n-1))},role:"button","aria-label":"Decrement meter",style:{fontSize:40,cursor:"pointer"}}),Object(K.jsx)("span",{children:n}),Object(K.jsx)(U.a,{onClick:function(){i(z(n+1))},role:"button","aria-label":"Increment meter",style:{fontSize:40,cursor:"pointer"}})]})]}),Object(K.jsx)(q,{}),Object(K.jsxs)("div",{style:{width:"150px"},children:[Object(K.jsx)("span",{style:{display:"block"},children:"Note"}),Object(K.jsxs)(J,{children:[Object(K.jsx)(Y,{onClick:function(){i(V(1))},role:"button","aria-label":"Quarter note pulse",selected:1===r,children:"\u2669"}),Object(K.jsx)(Y,{onClick:function(){i(V(.5))},role:"button","aria-label":"Eighth note pulse",selected:.5===r,children:"\u266b"})]})]})]})]})},$=n(52),ee=n(53),te=n(54),ne=n(57),re=n(58),ce=function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(e){var r,c=e.onTick;return Object($.a)(this,n),(r=t.call(this)).tempo=120,r.metre=4,r.division=1,r.nextNoteTime=0,r.stopPulse=null,r.onTick=c,r.beatCount=0,r.gainNode=r.createGain(),r}return Object(ee.a)(n,[{key:"init",value:function(){this.gainNode.connect(this.destination),this.gainNode.gain.value=.2,this.nextNoteTime=this.currentTime,this.startPulse()}},{key:"startPulse",value:function(){var e=this;this.stopPulse&&this.stopPulse();var t=setInterval((function(){return e.pulse()}),100);this.stopPulse=function(){clearInterval(t),e.beatCount=0}}},{key:"pulse",value:function(){for(;this.nextNoteTime<this.currentTime+.1;)this.nextNoteTime+=60/this.tempo*this.division,this.playTick(),this.beatCount+=this.division,this.beatCount===this.metre&&(this.beatCount=0)}},{key:"playTick",value:function(){var e=this.createOscillator();Number.isInteger(this.beatCount)&&(e.onended=this.onTick),e.connect(this.gainNode),e.frequency.value=this.getFrequency(),e.start(this.nextNoteTime),e.stop(this.nextNoteTime+.1)}},{key:"setTempo",value:function(e){this.tempo=e}},{key:"setMetre",value:function(e){this.metre=e}},{key:"setNoteValue",value:function(e){1===e&&(this.beatCount=Math.ceil(this.beatCount)),this.division=e}},{key:"getFrequency",value:function(){return this.beatCount%this.metre===0?550:Number.isInteger(this.beatCount)?450:350}}]),n}(Object(re.a)(AudioContext)),ie=C.c.div(s||(s=Object(y.a)(["\n  position: relative;\n  width: 100%;\n  height: 300px;\n  margin: auto;\n"]))),oe=C.c.span(u||(u=Object(y.a)(["\n  display: block;\n  font-size: 3rem;\n  text-align: center;\n"]))),ae=Object(C.d)(b||(b=Object(y.a)(["\n  0% {\n    transform: rotate(-45deg);\n  }\n  100% {\n    transform: rotate(45deg);\n  }\n"]))),se=C.c.div(l||(l=Object(y.a)(["\n  width: 2px;\n  height: 80%;\n  position: absolute;\n  left: 50%;\n  bottom: 0;\n  background-color: #c4c4c4;\n  transform-origin: bottom center;\n  animation: ",';\n\n  &:after {\n    content: "";\n    position: absolute;\n    top: ',"%;\n    left: 50%;\n    transform: translate(-50%);\n    width: 20px;\n    height: 20px;\n    border-radius: 50%;\n    background-color: #c4c4c4;\n    transition: top 0.5s;\n  }\n"])),(function(e){return e.isPlaying&&Object(C.b)(j||(j=Object(y.a)(["\n      "," ","s linear infinite alternate\n    "])),ae,60/e.tempo)}),(function(e){return(e.tempo-50)/168*100})),ue=function(){var e=Object(E.b)(),t=Object(E.c)((function(e){return e.metronome})),n=t.tempo,r=t.metre,c=t.noteValue,i=t.isPlaying,o=Object(h.useRef)(new ce({onTick:function(){return e({type:A,payload:t});var t}}));return Object(h.useEffect)((function(){o.current.setTempo(n)}),[n]),Object(h.useEffect)((function(){o.current.setMetre(r)}),[r]),Object(h.useEffect)((function(){o.current.setNoteValue(c)}),[c]),Object(h.useEffect)((function(){i?o.current.init():o.current.stopPulse&&(o.current.stopPulse(),setTimeout((function(){return e({type:S})}),1e3))}),[i,e]),Object(K.jsxs)(ie,{children:[Object(K.jsxs)(oe,{children:[n,"bpm"]}),Object(K.jsx)(se,{isPlaying:i,tempo:n})]})},be=n(36),le=n(3),je=n(55),me=C.c.form(m||(m=Object(y.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: 1rem;\n\n  & input {\n    width: 3em;\n    font: inherit;\n    padding: 0.2rem;\n    border: none;\n    border-radius: 3px;\n  }\n\n  & > * + * {\n    margin-left: 0.5rem;\n  }\n"]))),de=function(){var e=Object(E.c)((function(e){return e.program})).program,t=Object(E.b)(),n=Object(h.useState)({measures:4,metre:4,tempo:120,silent:!1}),r=Object(T.a)(n,2),c=r[0],i=r[1],o=function(){var n={measures:Number(c.measures),metre:Number(c.metre),tempo:Number(c.tempo),silent:c.silent,id:Object(je.v4)()};0===e.length&&t(D(n)),t({type:w,payload:n})},a=function(e){i(Object(le.a)(Object(le.a)({},c),{},Object(be.a)({},e.target.name,e.target.value)))};return Object(K.jsxs)(me,{onSubmit:o,children:[Object(K.jsx)("input",{type:"number",name:"measures",id:"measures",value:c.measures,onChange:a}),Object(K.jsx)("label",{htmlFor:"measures",children:"bars of"}),Object(K.jsx)("label",{htmlFor:"metre",children:Object(K.jsx)("input",{type:"number",name:"metre",id:"metre",value:c.metre,onChange:a})}),Object(K.jsx)("span",{children:"at"}),Object(K.jsx)("input",{type:"number",min:60,max:220,name:"tempo",id:"tempo",value:c.tempo,onChange:a}),Object(K.jsx)("label",{htmlFor:"tempo",children:"bpm"}),Object(K.jsx)(U.a,{role:"button",onClick:o,"aria-label":"Add to program",style:{fontSize:30,cursor:"pointer"}})]})},pe=function(){var e=Object(E.c)((function(e){return e.program})),t=e.program,n=e.currentChunk,r=Object(E.c)((function(e){return e.metronome.beatCount})),c=Object(E.b)();console.log(r);var i=function(e){1!==t.length?(e.id===n.id&&o(),c(function(e){return{type:I,payload:e}}(e))):c({type:R})},o=Object(h.useCallback)((function(){var e=t.indexOf(n)+1,r=t[e]||t[0];c(D(r))}),[n,t,c]);return Object(h.useEffect)((function(){n&&r===n.metre*n.measures&&o()}),[r,o,n]),Object(K.jsxs)("div",{children:[Object(K.jsx)(de,{}),t.map((function(e){return Object(K.jsxs)("p",{style:{textAlign:"center"},children:[e.measures," bars of ",e.metre," at ",e.tempo,"bpm"," ",Object(K.jsx)("button",{type:"button",onClick:function(){return i(e)},children:"Remove"})]},e.id)}))]})},Oe=function(){var e=Object(E.c)((function(e){return e.metronome})),t=e.tempo,n=e.metre,r=e.beatCount,c=e.isPlaying,i=Object(E.b)(),o=Object(h.useState)(0),a=Object(T.a)(o,2),s=a[0],u=a[1],b=Object(h.useState)(4),l=Object(T.a)(b,2),j=l[0],m=l[1];return Object(h.useEffect)((function(){c&&r%(j*n)===0&&(console.log(t+s),i(F(Math.min(t+Number(s),220))))}),[r]),Object(K.jsx)("div",{children:Object(K.jsxs)(me,{children:[Object(K.jsx)("label",{htmlFor:"tempo",children:"Increase tempo by"}),Object(K.jsx)("input",{min:0,max:50,type:"number",name:"tempoRamp",id:"tempo",value:s,onChange:function(e){return u(e.target.value)}}),Object(K.jsx)("span",{children:"bpm every"}),Object(K.jsx)("input",{min:1,type:"number",name:"measures",id:"measures",value:j,onChange:function(e){return m(e.target.value)}}),Object(K.jsx)("label",{htmlFor:"measures",children:"measures"})]})})},fe=C.c.nav(d||(d=Object(y.a)(["\n  display: flex;\n  justify-content: space-evenly;\n  font-size: 1.5rem;\n  margin-bottom: 2rem;\n"]))),he=C.c.span(p||(p=Object(y.a)(["\n  border-bottom: 2px solid #d3d3d3;\n  width: 200px;\n  text-align: center;\n  padding-bottom: 0.3rem;\n  position: relative;\n  color: ",';\n  cursor: pointer;\n  transition: color 0.3s;\n\n  &:after {\n    content: "";\n    position: absolute;\n    bottom: -2px;\n    left: 50%;\n    transform: translateX(-50%);\n    height: 2px;\n    width: ',";\n    background-color: red;\n    transition: width 0.3s;\n  }\n"])),(function(e){return e.isActive?"#dfdfdf":"#9d9d9d"}),(function(e){return e.isActive?"100%":"0"})),xe=function(){var e=Object(h.useState)(1),t=Object(T.a)(e,2),n=t[0],r=t[1];return Object(K.jsxs)("div",{style:{marginTop:"2rem"},children:[Object(K.jsxs)(fe,{children:[Object(K.jsx)(he,{isActive:1===n,onClick:function(){return r(1)},children:"Tempo ramp"}),Object(K.jsx)(he,{isActive:2===n,onClick:function(){return r(2)},children:"Custom"})]}),1===n&&Object(K.jsx)(Oe,{}),2===n&&Object(K.jsx)(pe,{})]})},ge=Object(C.a)(O||(O=Object(y.a)(["\n  body {\n    background-color: #333;\n    color: #dfdfdf;\n    font-family: 'Montserrat', sans-serif;\n  }\n"]))),ve=C.c.div(f||(f=Object(y.a)(["\n  width: 100%;\n  margin: 3rem auto 0 auto;\n\n  @media screen and (min-width: 600px) {\n    width: 600px;\n  }\n"]))),ye=function(){return Object(K.jsxs)(ve,{children:[Object(K.jsx)(ge,{}),Object(K.jsx)(ue,{}),Object(K.jsx)(Z,{}),Object(K.jsx)(xe,{})]})},Ce={tempo:120,metre:4,noteValue:1,isPlaying:!1,beatCount:0},Te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ce,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case k:return Object(le.a)(Object(le.a)({},e),{},{isPlaying:!e.isPlaying});case _:return Object(le.a)(Object(le.a)({},e),{},{tempo:r});case P:return Object(le.a)(Object(le.a)({},e),{},{metre:r});case N:return Object(le.a)(Object(le.a)({},e),{},{noteValue:r});case A:return Object(le.a)(Object(le.a)({},e),{},{beatCount:e.beatCount+1});case S:return Object(le.a)(Object(le.a)({},e),{},{beatCount:0});case M:return Object(le.a)(Object(le.a)({},e),{},{tempo:r.tempo,metre:r.metre,beatCount:0});default:return e}},Ee=n(27),ke=n(56),_e={program:[],currentChunk:{}},Pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_e,t=arguments.length>1?arguments[1]:void 0,n=t.type,r=t.payload;switch(n){case w:return Object(le.a)(Object(le.a)({},e),{},{program:[].concat(Object(ke.a)(e.program),[r])});case I:return Object(le.a)(Object(le.a)({},e),{},{program:e.program.filter((function(e){return e.id!==r.id}))});case M:return Object(le.a)(Object(le.a)({},e),{},{currentChunk:r});case R:return _e;default:return e}},Ne=Object(Ee.b)({metronome:Te,program:Pe}),Ae=Object(Ee.c)(Ne);v.a.render(Object(K.jsx)(x.a.StrictMode,{children:Object(K.jsx)(E.a,{store:Ae,children:Object(K.jsx)(ye,{})})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.9dbcb89b.chunk.js.map